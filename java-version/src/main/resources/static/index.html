<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning System - Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #666;
            font-size: 14px;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            background: white;
            color: #333;
            padding: 12px 24px;
            border: 2px solid #667eea;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .tab:hover {
            background: #f0f4ff;
            border-color: #5568d3;
            transform: translateY(-2px);
        }
        
        .tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-height: 500px;
        }
        
        .course-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .course-card {
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .course-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            transform: translateY(-4px);
        }
        
        .course-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .course-provider {
            color: #667eea;
            font-size: 14px;
            margin-bottom: 8px;
        }
        
        .course-level {
            display: inline-block;
            background: #f0f0f0;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .course-description {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        
        .course-link, .btn {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 6px;
            text-decoration: none;
            font-size: 14px;
            transition: background 0.3s;
            border: none;
            cursor: pointer;
            margin-right: 10px;
        }
        
        .course-link:hover, .btn:hover {
            background: #5568d3;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .success {
            background: #efe;
            color: #3c3;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .register-form {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        
        button[type="submit"] {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
        }
        
        button[type="submit"]:hover {
            background: #5568d3;
        }
        
        .skill-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .skill-item {
            border: 1px solid #e0e0e0;
            padding: 15px;
            border-radius: 8px;
            background: #f9f9f9;
        }
        
        .skill-name {
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .skill-level {
            color: #666;
            font-size: 12px;
        }
        
        .file-upload {
            border: 2px dashed #667eea;
            padding: 40px;
            text-align: center;
            border-radius: 8px;
            margin: 20px 0;
            cursor: pointer;
        }
        
        .file-upload:hover {
            background: #f0f4ff;
        }
        
        .recommendation-card {
            border: 1px solid #e0e0e0;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            background: #f9f9f9;
        }
        
        .recommendation-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: #667eea;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>üéì Learning System</h1>
                    <p class="subtitle">Platform for continuous professional development</p>
                </div>
                <div id="user-info" style="display: none;">
                    <p style="margin-bottom: 10px;"><strong id="user-name"></strong></p>
                    <button class="btn" onclick="logout()" style="width: auto; padding: 8px 16px;">Logout</button>
                </div>
            </div>
        </header>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('dashboard')">Dashboard</button>
            <button class="tab" onclick="showTab('courses')">Courses</button>
            <button class="tab" onclick="showTab('cv-upload')">CV Analysis</button>
            <button class="tab" onclick="showTab('profile')">Profile</button>
            <button class="tab" onclick="showTab('recommendations')">Recommendations</button>
            <button class="tab" onclick="showTab('enrollments')">My Courses</button>
            <button class="tab" onclick="showTab('market-trends')">Market Trends</button>
            <button class="tab" onclick="showTab('register')">Register</button>
            <button class="tab" onclick="showTab('login')">Login</button>
        </div>
        
        <div class="content">
            <!-- Dashboard Tab -->
            <div id="dashboard-tab">
                <h2>Dashboard</h2>
                <div id="dashboard-content">
                    <p>Welcome to Learning System! Use the tabs above to explore features.</p>
                    <div style="margin-top: 20px;">
                        <h3>Quick Actions:</h3>
                        <button class="btn" onclick="showTab('cv-upload')">Upload CV for Analysis</button>
                        <button class="btn" onclick="showTab('profile')">Manage Profile</button>
                        <button class="btn" onclick="showTab('recommendations')">Get Recommendations</button>
                    </div>
                </div>
            </div>
            
            <!-- Courses Tab -->
            <div id="courses-tab" style="display: none;">
                <h2>Available Courses</h2>
                <div id="courses-container" class="loading">Loading courses...</div>
            </div>
            
            <!-- CV Upload Tab -->
            <div id="cv-upload-tab" style="display: none;">
                <h2>CV Analysis</h2>
                <p>Upload your CV (PDF or DOCX) to analyze your skills and get personalized recommendations.</p>
                <div class="file-upload" onclick="document.getElementById('cv-file').click()">
                    <input type="file" id="cv-file" accept=".pdf,.docx" style="display: none;" onchange="handleCVUpload(event)">
                    <p>üìÑ Click to upload CV (PDF or DOCX)</p>
                    <p style="font-size: 12px; color: #666;">Selected: <span id="file-name">No file selected</span></p>
                </div>
                <button class="btn" onclick="analyzeCV()" style="width: 100%;">Analyze CV</button>
                <div id="cv-result"></div>
            </div>
            
            <!-- Profile Tab -->
            <div id="profile-tab" style="display: none;">
                <h2>User Profile</h2>
                <div id="profile-content">
                    <p>Please login first to view your profile.</p>
                    <div id="profile-form" style="display: none;">
                        <form onsubmit="updateProfile(event)">
                            <div class="form-group">
                                <label>Bio:</label>
                                <textarea id="profile-bio" rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Location:</label>
                                <input type="text" id="profile-location">
                            </div>
                            <div class="form-group">
                                <label>Career Goal:</label>
                                <input type="text" id="profile-career-goal">
                            </div>
                            <button type="submit">Update Profile</button>
                        </form>
                        <h3 style="margin-top: 30px;">My Skills</h3>
                        <div id="skills-container"></div>
                        <button class="btn" onclick="showAddSkillForm()" style="margin-top: 20px;">Add Skill</button>
                        <div id="add-skill-form" style="display: none; margin-top: 20px;">
                            <form onsubmit="addSkill(event)">
                                <div class="form-group">
                                    <label>Skill Name:</label>
                                    <input type="text" id="skill-name" required>
                                </div>
                                <div class="form-group">
                                    <label>Level (0-100):</label>
                                    <input type="number" id="skill-level" min="0" max="100" value="50" required>
                                </div>
                                <div class="form-group">
                                    <label>Category:</label>
                                    <select id="skill-category">
                                        <option value="programming">Programming</option>
                                        <option value="frontend">Frontend</option>
                                        <option value="backend">Backend</option>
                                        <option value="database">Database</option>
                                        <option value="devops">DevOps</option>
                                        <option value="ai">AI/ML</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <button type="submit">Add Skill</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Recommendations Tab -->
            <div id="recommendations-tab" style="display: none;">
                <h2>Personalized Recommendations</h2>
                <div id="recommendations-container">
                    <p id="rec-message">Loading recommendations...</p>
                </div>
            </div>
            
            <!-- Enrollments Tab -->
            <div id="enrollments-tab" style="display: none;">
                <h2>My Enrolled Courses</h2>
                <div id="enrollments-container">
                    <p id="enroll-message">Loading your courses...</p>
                </div>
            </div>
            
            <!-- Market Trends Tab -->
            <div id="market-trends-tab" style="display: none;">
                <h2>Market Trends</h2>
                <div id="market-trends-container" class="loading">Loading market trends...</div>
            </div>
            
            <!-- Register Tab -->
            <div id="register-tab" style="display: none;">
                <h2>Register New User</h2>
                <form class="register-form" onsubmit="registerUser(event)">
                    <div class="form-group">
                        <label>Name:</label>
                        <input type="text" id="reg-name" required>
                    </div>
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="reg-email" required>
                    </div>
                    <div class="form-group">
                        <label>Password:</label>
                        <input type="password" id="reg-password" required>
                    </div>
                    <button type="submit">Register</button>
                </form>
                <div id="register-result"></div>
            </div>
            
            <!-- Login Tab -->
            <div id="login-tab" style="display: none;">
                <h2>Login</h2>
                <form class="register-form" onsubmit="loginUser(event)">
                    <div class="form-group">
                        <label>Email:</label>
                        <input type="email" id="login-email" required>
                    </div>
                    <div class="form-group">
                        <label>Password:</label>
                        <input type="password" id="login-password" required>
                    </div>
                    <button type="submit">Login</button>
                </form>
                <div id="login-result"></div>
            </div>
        </div>
    </div>
    
    <script>
        const API_BASE = 'http://localhost:8080/api';
        let sessionId = localStorage.getItem('sessionId');
        let currentUser = null;
        
        // Helper function to get headers with session
        function getHeaders() {
            const headers = { 'Content-Type': 'application/json' };
            if (sessionId) {
                headers['X-Session-Id'] = sessionId;
            }
            return headers;
        }
        
        // Check session on load
        window.onload = function() {
            loadCourses();
            loadMarketTrends();
            if (sessionId) {
                checkSession();
            }
        };
        
        async function checkSession() {
            try {
                const response = await fetch(API_BASE + '/auth/session', {
                    headers: { 'X-Session-Id': sessionId }
                });
                if (response.ok) {
                    currentUser = await response.json();
                    updateUIForLoggedIn();
                } else {
                    sessionId = null;
                    localStorage.removeItem('sessionId');
                }
            } catch (error) {
                console.error('Session check failed:', error);
            }
        }
        
        function updateUIForLoggedIn() {
            if (currentUser) {
                document.getElementById('user-name').textContent = currentUser.name;
                document.getElementById('user-info').style.display = 'block';
            }
        }
        
        async function logout() {
            if (sessionId) {
                try {
                    await fetch(API_BASE + '/auth/logout', {
                        method: 'POST',
                        headers: { 'X-Session-Id': sessionId }
                    });
                } catch (error) {
                    console.error('Logout error:', error);
                }
            }
            sessionId = null;
            currentUser = null;
            localStorage.removeItem('sessionId');
            document.getElementById('user-info').style.display = 'none';
            alert('Logged out successfully');
            showTab('dashboard');
        }
        
        function showTab(tabName) {
            const tabs = ['dashboard', 'courses', 'cv-upload', 'profile', 'recommendations', 
                         'enrollments', 'market-trends', 'register', 'login'];
            tabs.forEach(tab => {
                document.getElementById(tab + '-tab').style.display = 'none';
            });
            document.getElementById(tabName + '-tab').style.display = 'block';
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Auto-load data when switching to certain tabs
            if (tabName === 'recommendations' && sessionId) {
                loadRecommendations();
            } else if (tabName === 'enrollments' && sessionId) {
                loadEnrollments();
            } else if (tabName === 'profile' && sessionId) {
                loadProfile();
            }
        }
        
        async function loadCourses() {
            const container = document.getElementById('courses-container');
            try {
                const response = await fetch(API_BASE + '/courses');
                const courses = await response.json();
                
                if (courses.length === 0) {
                    container.innerHTML = '<p>No courses available.</p>';
                    return;
                }
                
                container.innerHTML = '<div class="course-grid"></div>';
                const grid = container.querySelector('.course-grid');
                
                courses.forEach(course => {
                    const card = document.createElement('div');
                    card.className = 'course-card';
                    card.innerHTML = `
                        <div class="course-title">${course.title}</div>
                        <div class="course-provider">${course.provider || 'N/A'}</div>
                        <div class="course-level">${course.level || 'N/A'}</div>
                        <div class="course-description">${course.description || 'No description'}</div>
                        ${course.url ? `<a href="${course.url}" target="_blank" class="course-link">View Course</a>` : ''}
                        ${sessionId ? `<button class="btn" onclick="enrollInCourse(${course.id})">Enroll</button>` : ''}
                    `;
                    grid.appendChild(card);
                });
            } catch (error) {
                container.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        function handleCVUpload(event) {
            const file = event.target.files[0];
            document.getElementById('file-name').textContent = file ? file.name : 'No file selected';
        }
        
        async function analyzeCV() {
            const fileInput = document.getElementById('cv-file');
            const file = fileInput.files[0];
            const resultDiv = document.getElementById('cv-result');
            
            if (!file) {
                resultDiv.innerHTML = '<div class="error">Please select a file first.</div>';
                return;
            }
            
            resultDiv.innerHTML = '<div class="loading">Analyzing CV...</div>';
            
            const formData = new FormData();
            formData.append('file', file);
            
            const headers = {};
            if (sessionId) {
                headers['X-Session-Id'] = sessionId;
            }
            
            try {
                const response = await fetch(API_BASE + '/cv-analysis', {
                    method: 'POST',
                    headers: headers,
                    body: formData
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    let html = '<div class="success">‚úÖ CV analyzed successfully!</div>';
                    html += '<h3>Extracted Skills:</h3><ul>';
                    result.cvData.skills.forEach(skill => {
                        html += `<li>${skill.name} - ${skill.level} (${skill.category})</li>`;
                    });
                    html += '</ul>';
                    
                    if (result.recommendations) {
                        html += '<h3>Recommendations:</h3>';
                        result.recommendations.courses.forEach(course => {
                            html += `<div class="recommendation-card">
                                <div class="recommendation-title">${course.title}</div>
                                <p>Relevance: ${(course.relevance * 100).toFixed(0)}%</p>
                            </div>`;
                        });
                    }
                    
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = `<div class="error">Error: ${result.error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function loadRecommendations() {
            const container = document.getElementById('recommendations-container');
            
            if (!sessionId) {
                container.innerHTML = '<div class="error">Please login first to get recommendations</div>';
                return;
            }
            
            container.innerHTML = '<div class="loading">Loading recommendations...</div>';
            
            try {
                const response = await fetch(API_BASE + '/recommendations', {
                    headers: { 'X-Session-Id': sessionId }
                });
                const recs = await response.json();
                
                let html = '<h3>Recommended Courses:</h3>';
                recs.courses.forEach(course => {
                    html += `<div class="recommendation-card">
                        <div class="recommendation-title">${course.title}</div>
                        <p>Relevance: ${(course.relevance * 100).toFixed(0)}%</p>
                        <p>Provider: ${course.provider}</p>
                    </div>`;
                });
                
                html += '<h3>Career Paths:</h3>';
                recs.careerPaths.forEach(path => {
                    html += `<div class="recommendation-card">
                        <div class="recommendation-title">${path.title}</div>
                        <p>Match: ${path.matchPercentage}</p>
                        <p>${path.description}</p>
                    </div>`;
                });
                
                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function loadEnrollments() {
            const container = document.getElementById('enrollments-container');
            
            if (!sessionId) {
                container.innerHTML = '<div class="error">Please login first to view your courses</div>';
                return;
            }
            
            try {
                const response = await fetch(API_BASE + '/enrollments', {
                    headers: { 'X-Session-Id': sessionId }
                });
                const enrollments = await response.json();
                
                if (enrollments.length === 0) {
                    container.innerHTML = '<p>No enrolled courses.</p>';
                    return;
                }
                
                let html = '';
                enrollments.forEach(enrollment => {
                    html += `<div class="recommendation-card">
                        <div class="recommendation-title">${enrollment.title}</div>
                        <p>Provider: ${enrollment.provider}</p>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${enrollment.progress}%"></div>
                        </div>
                        <p>Progress: ${enrollment.progress}%</p>
                    </div>`;
                });
                
                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function enrollInCourse(courseId) {
            if (!sessionId) {
                alert('Please login first');
                showTab('login');
                return;
            }
            
            try {
                const formData = new FormData();
                formData.append('courseId', courseId);
                
                const response = await fetch(API_BASE + '/enrollments?courseId=' + courseId, {
                    method: 'POST',
                    headers: { 'X-Session-Id': sessionId }
                });
                
                if (response.ok) {
                    alert('Enrolled successfully!');
                } else {
                    alert('Enrollment failed');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
        
        async function loadMarketTrends() {
            const container = document.getElementById('market-trends-container');
            try {
                const response = await fetch(API_BASE + '/market-trends');
                const trends = await response.json();
                
                let html = '<div class="course-grid">';
                trends.forEach(trend => {
                    html += `<div class="course-card">
                        <div class="course-title">${trend.skillName}</div>
                        <p>Demand: ${trend.demand}</p>
                        <p>Growth: ${trend.growthPercentage}%</p>
                        <p>Avg Salary: $${trend.avgSalary}</p>
                    </div>`;
                });
                html += '</div>';
                
                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function registerUser(event) {
            event.preventDefault();
            const resultDiv = document.getElementById('register-result');
            resultDiv.innerHTML = '<div class="loading">Registering...</div>';
            
            const userData = {
                name: document.getElementById('reg-name').value,
                email: document.getElementById('reg-email').value,
                password: document.getElementById('reg-password').value
            };
            
            try {
                const response = await fetch(API_BASE + '/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(userData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="success">‚úÖ ${result.message}<br>User: ${result.user.name} (${result.user.email})</div>`;
                    sessionId = result.sessionId;
                    currentUser = result.user;
                    localStorage.setItem('sessionId', sessionId);
                    updateUIForLoggedIn();
                    document.querySelector('#register-tab form').reset();
                } else {
                    resultDiv.innerHTML = `<div class="error">‚ùå ${result.error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function loginUser(event) {
            event.preventDefault();
            const resultDiv = document.getElementById('login-result');
            resultDiv.innerHTML = '<div class="loading">Logging in...</div>';
            
            const loginData = {
                email: document.getElementById('login-email').value,
                password: document.getElementById('login-password').value
            };
            
            try {
                const response = await fetch(API_BASE + '/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(loginData)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    resultDiv.innerHTML = `<div class="success">‚úÖ ${result.message}<br>Welcome, ${result.user.name}!</div>`;
                    sessionId = result.sessionId;
                    currentUser = result.user;
                    localStorage.setItem('sessionId', sessionId);
                    updateUIForLoggedIn();
                    document.querySelector('#login-tab form').reset();
                    loadProfile();
                } else {
                    resultDiv.innerHTML = `<div class="error">‚ùå ${result.error}</div>`;
                }
            } catch (error) {
                resultDiv.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        async function loadProfile() {
            if (!sessionId) {
                document.getElementById('profile-content').innerHTML = '<p>Please login first to view your profile.</p>';
                return;
            }
            
            try {
                const response = await fetch(API_BASE + '/profile', {
                    headers: { 'X-Session-Id': sessionId }
                });
                const data = await response.json();
                
                if (data.profile) {
                    document.getElementById('profile-bio').value = data.profile.bio || '';
                    document.getElementById('profile-location').value = data.profile.location || '';
                    document.getElementById('profile-career-goal').value = data.profile.careerGoal || '';
                    document.getElementById('profile-form').style.display = 'block';
                }
                
                if (data.skills) {
                    const skillsContainer = document.getElementById('skills-container');
                    skillsContainer.innerHTML = '<div class="skill-list"></div>';
                    const list = skillsContainer.querySelector('.skill-list');
                    
                    data.skills.forEach(skill => {
                        const item = document.createElement('div');
                        item.className = 'skill-item';
                        item.innerHTML = `
                            <div class="skill-name">${skill.skillName}</div>
                            <div class="skill-level">Level: ${skill.skillLevel}/100</div>
                            <div class="skill-level">Category: ${skill.category}</div>
                        `;
                        list.appendChild(item);
                    });
                }
            } catch (error) {
                console.error('Error loading profile:', error);
            }
        }
        
        async function updateProfile(event) {
            event.preventDefault();
            if (!sessionId) {
                alert('Please login first');
                return;
            }
            
            const profile = {
                bio: document.getElementById('profile-bio').value,
                location: document.getElementById('profile-location').value,
                careerGoal: document.getElementById('profile-career-goal').value
            };
            
            try {
                const response = await fetch(API_BASE + '/profile', {
                    method: 'PUT',
                    headers: getHeaders(),
                    body: JSON.stringify(profile)
                });
                
                if (response.ok) {
                    alert('Profile updated successfully!');
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
        
        function showAddSkillForm() {
            document.getElementById('add-skill-form').style.display = 'block';
        }
        
        async function addSkill(event) {
            event.preventDefault();
            if (!sessionId) {
                alert('Please login first');
                return;
            }
            
            const skill = {
                skillName: document.getElementById('skill-name').value,
                skillLevel: parseInt(document.getElementById('skill-level').value),
                category: document.getElementById('skill-category').value
            };
            
            try {
                const response = await fetch(API_BASE + '/profile/skills', {
                    method: 'POST',
                    headers: getHeaders(),
                    body: JSON.stringify(skill)
                });
                
                if (response.ok) {
                    alert('Skill added successfully!');
                    document.getElementById('add-skill-form').style.display = 'none';
                    document.querySelector('#add-skill-form form').reset();
                    loadProfile();
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }
    </script>
</body>
</html>
